{"ast":null,"code":"var domain=\"https://pure-album-378218.ue.r.appspot.com\";// example: http://localhost:8080\nvar handleResponseStatus=function handleResponseStatus(response,errMsg){var status=response.status,ok=response.ok;if(status===401){localStorage.removeItem(\"authToken\");// web storage\nwindow.location.reload();return;}if(!ok){throw Error(errMsg);}};export var login=function login(credential){var url=\"\".concat(domain,\"/signin\");return fetch(url,{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(credential)}).then(function(response){if(!response.ok){throw Error(\"Fail to log in\");}return response.text();}).then(function(token){localStorage.setItem(\"authToken\",token);});};export var register=function register(credential){var url=\"\".concat(domain,\"/signup\");return fetch(url,{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(credential)}).then(function(response){handleResponseStatus(response,\"Fail to register\");});};export var uploadApp=function uploadApp(data,file){var authToken=localStorage.getItem(\"authToken\");var url=\"\".concat(domain,\"/upload\");var title=data.title,description=data.description,price=data.price;var formData=new FormData();formData.append(\"title\",title);formData.append(\"description\",description);formData.append(\"price\",price);formData.append(\"media_file\",file);return fetch(url,{method:\"POST\",headers:{Authorization:\"Bearer \".concat(authToken)},body:formData}).then(function(response){handleResponseStatus(response,\"Fail to upload app\");});};export var searchApps=function searchApps(query){var _query$title,_query$description;var title=(_query$title=query===null||query===void 0?void 0:query.title)!==null&&_query$title!==void 0?_query$title:\"\";var description=(_query$description=query===null||query===void 0?void 0:query.description)!==null&&_query$description!==void 0?_query$description:\"\";var authToken=localStorage.getItem(\"authToken\");var url=new URL(\"\".concat(domain,\"/search\"));url.searchParams.append(\"title\",title);url.searchParams.append(\"description\",description);return fetch(url,{headers:{Authorization:\"Bearer \".concat(authToken)}}).then(function(response){handleResponseStatus(response,\"Fail to search apps\");return response.json();});};export var checkout=function checkout(appId){var authToken=localStorage.getItem(\"authToken\");var url=\"\".concat(domain,\"/checkout?appID=\").concat(appId);return fetch(url,{method:\"POST\",headers:{Authorization:\"Bearer \".concat(authToken),\"Content-Type\":\"application/json\"}}).then(function(response){handleResponseStatus(response,\"Fail to checkout\");return response.text();}).then(function(redirectUrl){window.location=redirectUrl;});};","map":{"version":3,"names":["domain","handleResponseStatus","response","errMsg","status","ok","localStorage","removeItem","window","location","reload","Error","login","credential","url","concat","fetch","method","headers","body","JSON","stringify","then","text","token","setItem","register","uploadApp","data","file","authToken","getItem","title","description","price","formData","FormData","append","Authorization","searchApps","query","_query$title","_query$description","URL","searchParams","json","checkout","appId","redirectUrl"],"sources":["/Users/sparklet/appstore-client/appstore/src/utils.js"],"sourcesContent":["const domain = \"https://pure-album-378218.ue.r.appspot.com\";  // example: http://localhost:8080\n\nconst handleResponseStatus = (response, errMsg) => {\n  const { status, ok } = response;\n\n  if (status === 401) {\n    localStorage.removeItem(\"authToken\"); // web storage\n    window.location.reload();\n    return;\n  }\n\n  if (!ok) {\n    throw Error(errMsg);\n  }\n};\n\nexport const login = (credential) => {\n  const url = `${domain}/signin`;\n  return fetch(url, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    body: JSON.stringify(credential),\n  })\n    .then((response) => {\n      if (!response.ok) {\n        throw Error(\"Fail to log in\");\n      }\n\n      return response.text();\n    })\n    .then((token) => {\n      localStorage.setItem(\"authToken\", token);\n    });\n};\n\nexport const register = (credential) => {\n  const url = `${domain}/signup`;\n  return fetch(url, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    body: JSON.stringify(credential),\n  }).then((response) => {\n    handleResponseStatus(response, \"Fail to register\");\n  });\n};\n\nexport const uploadApp = (data, file) => {\n  const authToken = localStorage.getItem(\"authToken\");\n  const url = `${domain}/upload`;\n\n  const { title, description, price } = data;\n  const formData = new FormData();\n  formData.append(\"title\", title);\n  formData.append(\"description\", description);\n  formData.append(\"price\", price);\n  formData.append(\"media_file\", file);\n\n  return fetch(url, {\n    method: \"POST\",\n    headers: {\n      Authorization: `Bearer ${authToken}`,\n    },\n    body: formData,\n  }).then((response) => {\n    handleResponseStatus(response, \"Fail to upload app\");\n  });\n};\n\nexport const searchApps = (query) => {\n  const title = query?.title ?? \"\";\n  const description = query?.description ?? \"\";\n\n  const authToken = localStorage.getItem(\"authToken\");\n  const url = new URL(`${domain}/search`);\n  url.searchParams.append(\"title\", title);\n  url.searchParams.append(\"description\", description);\n\n  return fetch(url, {\n    headers: {\n      Authorization: `Bearer ${authToken}`,\n    },\n  }).then((response) => {\n    handleResponseStatus(response, \"Fail to search apps\");\n\n    return response.json();\n  });\n};\n\nexport const checkout = (appId) => {\n  const authToken = localStorage.getItem(\"authToken\");\n  const url = `${domain}/checkout?appID=${appId}`;\n\n  return fetch(url, {\n    method: \"POST\",\n    headers: {\n      Authorization: `Bearer ${authToken}`,\n      \"Content-Type\": \"application/json\",\n    },\n  })\n    .then((response) => {\n      handleResponseStatus(response, \"Fail to checkout\");\n\n      return response.text();\n    })\n    .then((redirectUrl) => {\n      window.location = redirectUrl;\n    });\n};\n"],"mappings":"AAAA,GAAM,CAAAA,MAAM,CAAG,4CAA4C,CAAG;AAE9D,GAAM,CAAAC,oBAAoB,CAAG,QAAvB,CAAAA,oBAAoBA,CAAIC,QAAQ,CAAEC,MAAM,CAAK,CACjD,GAAQ,CAAAC,MAAM,CAASF,QAAQ,CAAvBE,MAAM,CAAEC,EAAE,CAAKH,QAAQ,CAAfG,EAAE,CAElB,GAAID,MAAM,GAAK,GAAG,CAAE,CAClBE,YAAY,CAACC,UAAU,CAAC,WAAW,CAAC,CAAE;AACtCC,MAAM,CAACC,QAAQ,CAACC,MAAM,EAAE,CACxB,OACF,CAEA,GAAI,CAACL,EAAE,CAAE,CACP,KAAM,CAAAM,KAAK,CAACR,MAAM,CAAC,CACrB,CACF,CAAC,CAED,MAAO,IAAM,CAAAS,KAAK,CAAG,QAAR,CAAAA,KAAKA,CAAIC,UAAU,CAAK,CACnC,GAAM,CAAAC,GAAG,IAAAC,MAAA,CAAMf,MAAM,WAAS,CAC9B,MAAO,CAAAgB,KAAK,CAACF,GAAG,CAAE,CAChBG,MAAM,CAAE,MAAM,CACdC,OAAO,CAAE,CACP,cAAc,CAAE,kBAClB,CAAC,CACDC,IAAI,CAAEC,IAAI,CAACC,SAAS,CAACR,UAAU,CACjC,CAAC,CAAC,CACCS,IAAI,CAAC,SAACpB,QAAQ,CAAK,CAClB,GAAI,CAACA,QAAQ,CAACG,EAAE,CAAE,CAChB,KAAM,CAAAM,KAAK,CAAC,gBAAgB,CAAC,CAC/B,CAEA,MAAO,CAAAT,QAAQ,CAACqB,IAAI,EAAE,CACxB,CAAC,CAAC,CACDD,IAAI,CAAC,SAACE,KAAK,CAAK,CACflB,YAAY,CAACmB,OAAO,CAAC,WAAW,CAAED,KAAK,CAAC,CAC1C,CAAC,CAAC,CACN,CAAC,CAED,MAAO,IAAM,CAAAE,QAAQ,CAAG,QAAX,CAAAA,QAAQA,CAAIb,UAAU,CAAK,CACtC,GAAM,CAAAC,GAAG,IAAAC,MAAA,CAAMf,MAAM,WAAS,CAC9B,MAAO,CAAAgB,KAAK,CAACF,GAAG,CAAE,CAChBG,MAAM,CAAE,MAAM,CACdC,OAAO,CAAE,CACP,cAAc,CAAE,kBAClB,CAAC,CACDC,IAAI,CAAEC,IAAI,CAACC,SAAS,CAACR,UAAU,CACjC,CAAC,CAAC,CAACS,IAAI,CAAC,SAACpB,QAAQ,CAAK,CACpBD,oBAAoB,CAACC,QAAQ,CAAE,kBAAkB,CAAC,CACpD,CAAC,CAAC,CACJ,CAAC,CAED,MAAO,IAAM,CAAAyB,SAAS,CAAG,QAAZ,CAAAA,SAASA,CAAIC,IAAI,CAAEC,IAAI,CAAK,CACvC,GAAM,CAAAC,SAAS,CAAGxB,YAAY,CAACyB,OAAO,CAAC,WAAW,CAAC,CACnD,GAAM,CAAAjB,GAAG,IAAAC,MAAA,CAAMf,MAAM,WAAS,CAE9B,GAAQ,CAAAgC,KAAK,CAAyBJ,IAAI,CAAlCI,KAAK,CAAEC,WAAW,CAAYL,IAAI,CAA3BK,WAAW,CAAEC,KAAK,CAAKN,IAAI,CAAdM,KAAK,CACjC,GAAM,CAAAC,QAAQ,CAAG,GAAI,CAAAC,QAAQ,EAAE,CAC/BD,QAAQ,CAACE,MAAM,CAAC,OAAO,CAAEL,KAAK,CAAC,CAC/BG,QAAQ,CAACE,MAAM,CAAC,aAAa,CAAEJ,WAAW,CAAC,CAC3CE,QAAQ,CAACE,MAAM,CAAC,OAAO,CAAEH,KAAK,CAAC,CAC/BC,QAAQ,CAACE,MAAM,CAAC,YAAY,CAAER,IAAI,CAAC,CAEnC,MAAO,CAAAb,KAAK,CAACF,GAAG,CAAE,CAChBG,MAAM,CAAE,MAAM,CACdC,OAAO,CAAE,CACPoB,aAAa,WAAAvB,MAAA,CAAYe,SAAS,CACpC,CAAC,CACDX,IAAI,CAAEgB,QACR,CAAC,CAAC,CAACb,IAAI,CAAC,SAACpB,QAAQ,CAAK,CACpBD,oBAAoB,CAACC,QAAQ,CAAE,oBAAoB,CAAC,CACtD,CAAC,CAAC,CACJ,CAAC,CAED,MAAO,IAAM,CAAAqC,UAAU,CAAG,QAAb,CAAAA,UAAUA,CAAIC,KAAK,CAAK,KAAAC,YAAA,CAAAC,kBAAA,CACnC,GAAM,CAAAV,KAAK,EAAAS,YAAA,CAAGD,KAAK,SAALA,KAAK,iBAALA,KAAK,CAAER,KAAK,UAAAS,YAAA,UAAAA,YAAA,CAAI,EAAE,CAChC,GAAM,CAAAR,WAAW,EAAAS,kBAAA,CAAGF,KAAK,SAALA,KAAK,iBAALA,KAAK,CAAEP,WAAW,UAAAS,kBAAA,UAAAA,kBAAA,CAAI,EAAE,CAE5C,GAAM,CAAAZ,SAAS,CAAGxB,YAAY,CAACyB,OAAO,CAAC,WAAW,CAAC,CACnD,GAAM,CAAAjB,GAAG,CAAG,GAAI,CAAA6B,GAAG,IAAA5B,MAAA,CAAIf,MAAM,YAAU,CACvCc,GAAG,CAAC8B,YAAY,CAACP,MAAM,CAAC,OAAO,CAAEL,KAAK,CAAC,CACvClB,GAAG,CAAC8B,YAAY,CAACP,MAAM,CAAC,aAAa,CAAEJ,WAAW,CAAC,CAEnD,MAAO,CAAAjB,KAAK,CAACF,GAAG,CAAE,CAChBI,OAAO,CAAE,CACPoB,aAAa,WAAAvB,MAAA,CAAYe,SAAS,CACpC,CACF,CAAC,CAAC,CAACR,IAAI,CAAC,SAACpB,QAAQ,CAAK,CACpBD,oBAAoB,CAACC,QAAQ,CAAE,qBAAqB,CAAC,CAErD,MAAO,CAAAA,QAAQ,CAAC2C,IAAI,EAAE,CACxB,CAAC,CAAC,CACJ,CAAC,CAED,MAAO,IAAM,CAAAC,QAAQ,CAAG,QAAX,CAAAA,QAAQA,CAAIC,KAAK,CAAK,CACjC,GAAM,CAAAjB,SAAS,CAAGxB,YAAY,CAACyB,OAAO,CAAC,WAAW,CAAC,CACnD,GAAM,CAAAjB,GAAG,IAAAC,MAAA,CAAMf,MAAM,qBAAAe,MAAA,CAAmBgC,KAAK,CAAE,CAE/C,MAAO,CAAA/B,KAAK,CAACF,GAAG,CAAE,CAChBG,MAAM,CAAE,MAAM,CACdC,OAAO,CAAE,CACPoB,aAAa,WAAAvB,MAAA,CAAYe,SAAS,CAAE,CACpC,cAAc,CAAE,kBAClB,CACF,CAAC,CAAC,CACCR,IAAI,CAAC,SAACpB,QAAQ,CAAK,CAClBD,oBAAoB,CAACC,QAAQ,CAAE,kBAAkB,CAAC,CAElD,MAAO,CAAAA,QAAQ,CAACqB,IAAI,EAAE,CACxB,CAAC,CAAC,CACDD,IAAI,CAAC,SAAC0B,WAAW,CAAK,CACrBxC,MAAM,CAACC,QAAQ,CAAGuC,WAAW,CAC/B,CAAC,CAAC,CACN,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}