{"ast":null,"code":"const domain = \"https://pure-album-378218.ue.r.appspot.com\"; // example: http://localhost:8080\n\nconst handleResponseStatus = (response, errMsg) => {\n  const {\n    status,\n    ok\n  } = response;\n  if (status === 401) {\n    localStorage.removeItem(\"authToken\"); // web storage\n    window.location.reload();\n    return;\n  }\n  if (!ok) {\n    throw Error(errMsg);\n  }\n};\nexport const login = credential => {\n  const url = `${domain}/signin`;\n  return fetch(url, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    body: JSON.stringify(credential)\n  }).then(response => {\n    if (!response.ok) {\n      throw Error(\"Fail to log in\");\n    }\n    return response.text();\n  }).then(token => {\n    localStorage.setItem(\"authToken\", token);\n  });\n};\nexport const register = credential => {\n  const url = `${domain}/signup`;\n  return fetch(url, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    body: JSON.stringify(credential)\n  }).then(response => {\n    handleResponseStatus(response, \"Fail to register\");\n  });\n};\nexport const uploadApp = (data, file) => {\n  const authToken = localStorage.getItem(\"authToken\");\n  const url = `${domain}/upload`;\n  const {\n    title,\n    description,\n    price\n  } = data;\n  const formData = new FormData();\n  formData.append(\"title\", title);\n  formData.append(\"description\", description);\n  formData.append(\"price\", price);\n  formData.append(\"media_file\", file);\n  return fetch(url, {\n    method: \"POST\",\n    headers: {\n      Authorization: `Bearer ${authToken}`\n    },\n    body: formData\n  }).then(response => {\n    handleResponseStatus(response, \"Fail to upload app\");\n  });\n};\nexport const searchApps = query => {\n  var _query$title, _query$description;\n  const title = (_query$title = query === null || query === void 0 ? void 0 : query.title) !== null && _query$title !== void 0 ? _query$title : \"\";\n  const description = (_query$description = query === null || query === void 0 ? void 0 : query.description) !== null && _query$description !== void 0 ? _query$description : \"\";\n  const authToken = localStorage.getItem(\"authToken\");\n  const url = new URL(`${domain}/search`);\n  url.searchParams.append(\"title\", title);\n  url.searchParams.append(\"description\", description);\n  return fetch(url, {\n    headers: {\n      Authorization: `Bearer ${authToken}`\n    }\n  }).then(response => {\n    handleResponseStatus(response, \"Fail to search apps\");\n    return response.json();\n  });\n};\nexport const checkout = appId => {\n  const authToken = localStorage.getItem(\"authToken\");\n  const url = `${domain}/checkout?appID=${appId}`;\n  return fetch(url, {\n    method: \"POST\",\n    headers: {\n      Authorization: `Bearer ${authToken}`,\n      \"Content-Type\": \"application/json\"\n    }\n  }).then(response => {\n    handleResponseStatus(response, \"Fail to checkout\");\n    return response.text();\n  }).then(redirectUrl => {\n    window.location = redirectUrl;\n  });\n};","map":{"version":3,"names":["domain","handleResponseStatus","response","errMsg","status","ok","localStorage","removeItem","window","location","reload","Error","login","credential","url","fetch","method","headers","body","JSON","stringify","then","text","token","setItem","register","uploadApp","data","file","authToken","getItem","title","description","price","formData","FormData","append","Authorization","searchApps","query","_query$title","_query$description","URL","searchParams","json","checkout","appId","redirectUrl"],"sources":["/Users/sparklet/appstore-client/appstore/src/utils.js"],"sourcesContent":["const domain = \"https://pure-album-378218.ue.r.appspot.com\";  // example: http://localhost:8080\n\nconst handleResponseStatus = (response, errMsg) => {\n  const { status, ok } = response;\n\n  if (status === 401) {\n    localStorage.removeItem(\"authToken\"); // web storage\n    window.location.reload();\n    return;\n  }\n\n  if (!ok) {\n    throw Error(errMsg);\n  }\n};\n\nexport const login = (credential) => {\n  const url = `${domain}/signin`;\n  return fetch(url, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    body: JSON.stringify(credential),\n  })\n    .then((response) => {\n      if (!response.ok) {\n        throw Error(\"Fail to log in\");\n      }\n\n      return response.text();\n    })\n    .then((token) => {\n      localStorage.setItem(\"authToken\", token);\n    });\n};\n\nexport const register = (credential) => {\n  const url = `${domain}/signup`;\n  return fetch(url, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    body: JSON.stringify(credential),\n  }).then((response) => {\n    handleResponseStatus(response, \"Fail to register\");\n  });\n};\n\nexport const uploadApp = (data, file) => {\n  const authToken = localStorage.getItem(\"authToken\");\n  const url = `${domain}/upload`;\n\n  const { title, description, price } = data;\n  const formData = new FormData();\n  formData.append(\"title\", title);\n  formData.append(\"description\", description);\n  formData.append(\"price\", price);\n  formData.append(\"media_file\", file);\n\n  return fetch(url, {\n    method: \"POST\",\n    headers: {\n      Authorization: `Bearer ${authToken}`,\n    },\n    body: formData,\n  }).then((response) => {\n    handleResponseStatus(response, \"Fail to upload app\");\n  });\n};\n\nexport const searchApps = (query) => {\n  const title = query?.title ?? \"\";\n  const description = query?.description ?? \"\";\n\n  const authToken = localStorage.getItem(\"authToken\");\n  const url = new URL(`${domain}/search`);\n  url.searchParams.append(\"title\", title);\n  url.searchParams.append(\"description\", description);\n\n  return fetch(url, {\n    headers: {\n      Authorization: `Bearer ${authToken}`,\n    },\n  }).then((response) => {\n    handleResponseStatus(response, \"Fail to search apps\");\n\n    return response.json();\n  });\n};\n\nexport const checkout = (appId) => {\n  const authToken = localStorage.getItem(\"authToken\");\n  const url = `${domain}/checkout?appID=${appId}`;\n\n  return fetch(url, {\n    method: \"POST\",\n    headers: {\n      Authorization: `Bearer ${authToken}`,\n      \"Content-Type\": \"application/json\",\n    },\n  })\n    .then((response) => {\n      handleResponseStatus(response, \"Fail to checkout\");\n\n      return response.text();\n    })\n    .then((redirectUrl) => {\n      window.location = redirectUrl;\n    });\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}